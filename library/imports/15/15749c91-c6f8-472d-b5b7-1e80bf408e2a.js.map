{"version":3,"sources":["assets\\scripts\\cc_scripts\\Seat.js"],"names":["cc","Class","Component","properties","_sprIcon","_ready","_lblName","_lblScore","_scoreBg","_voicemsg","_chatBubble","_emoji","_lastChatTime","_userName","_score","_isReady","_userId","_holds","_chatstr","onLoad","node","getChildByName","getComponent","Label","icon","Sprite","card","active","avatarUrl","Button","refresh","onIconClicked","refreshcount1","length","string","refreshcount2","log","self","loader","load","url","type","err","tex","spriteFrame","SpriteFrame","setInfo","name","score","dayingjia","_dayingjia","setReady","isReady","setID","id","idNode","lbl","setUserID","chat","content","emoji","console","Animation","play","voiceMsg","show","refreshXuanPaiState","update","dt","stop"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _sprIcon:null,\r\n        _ready:null,\r\n        _lblName:null,\r\n        _lblScore:null,\r\n        _scoreBg:null,\r\n        _voicemsg:null,\r\n        \r\n        _chatBubble:null,\r\n        //card:null,\r\n        _emoji:null,\r\n        _lastChatTime:-1,\r\n        \r\n        _userName:\"\",\r\n        _score:0,\r\n        _isReady:false,\r\n        _userId:null,\r\n        _holds:[],\r\n        _chatstr:\"\",\r\n        //avatarUrl:\"\",\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        \r\n    //    this._sprIcon = this.node.getChildByName(\"icon\").getComponent(\"ImageLoader\");\r\n        this._lblName = this.node.getChildByName(\"name\").getComponent(cc.Label);\r\n        this._lblScore = this.node.getChildByName(\"score\").getComponent(cc.Label);\r\n        this._voicemsg = this.node.getChildByName(\"voicemsg\");\r\n\r\n        this.icon=this.node.getChildByName(\"icon\").getComponent(cc.Sprite);\r\n\r\n        this.card=this.node.getChildByName(\"card\")\r\n        this.card.active=false;\r\n        this.avatarUrl=\"\"\r\n\r\n        if(this._voicemsg){\r\n            this._voicemsg.active = false;\r\n        }\r\n        \r\n        if(this._sprIcon && this._sprIcon.getComponent(cc.Button)){\r\n            //cc.vv.utils.addClickEvent(this._sprIcon,this.node,\"Seat\",\"onIconClicked\");    \r\n        }\r\n        \r\n        \r\n        //this._offline = this.node.getChildByName(\"offline\");\r\n        \r\n        this._ready = this.node.getChildByName(\"ready\");\r\n        this._isReady=false\r\n        \r\n        //this._zhuang = this.node.getChildByName(\"zhuang\");\r\n        \r\n        this._scoreBg = this.node.getChildByName(\"Z_money_frame\");\r\n        //this._nddayingjia = this.node.getChildByName(\"dayingjia\");\r\n        \r\n        this._chatBubble = this.node.getChildByName(\"ChatBubble\");\r\n        //this._chatBubble.setLocalZOrder(9999)\r\n        //this._chatBubble.zIndex=99999\r\n        if(this._chatBubble != null){\r\n            this._chatBubble.active = false;            \r\n        }\r\n        \r\n        this._emoji = this.node.getChildByName(\"emoji\");\r\n        if(this._emoji != null){\r\n            this._emoji.active = false;\r\n        }\r\n    \r\n       this._lblScore.node.active=false\r\n        this.refresh();\r\n        \r\n    },\r\n    \r\n    onIconClicked:function(){\r\n    },\r\n   refreshcount1:function(){\r\n        this._score=this._holds.length+2\r\n        if(this._lblScore != null && this._score>0){\r\n            this._lblScore.node.active=true\r\n            this._lblScore.string = \"余\"+this._score+\"张\";            \r\n        }\r\n        else{\r\n            this._lblScore.node.active=false\r\n        } \r\n   },\r\n   refreshcount2:function(){\r\n    this._score=this._holds.length\r\n    if(this._lblScore != null && this._score>0){\r\n        this._lblScore.node.active=true\r\n        this._lblScore.string = \"余\"+this._score+\"张\";            \r\n    }\r\n    else{\r\n        this._lblScore.node.active=false\r\n    } \r\n},\r\n    refresh:function(){\r\n        if(this._lblName != null){\r\n            this._lblName.string = this._userName;    \r\n        }       \r\n        if(this._ready){\r\n            this._ready.active = this._isReady; \r\n        }\r\n        cc.log(\"this._isReady=\",this._isReady)\r\n       // this._ready.active = true; \r\n        this.node.active = this._userName != null && this._userName != \"\"; \r\n        cc.log(\"this._holds.length=\",this._holds.length)\r\n        if(this._holds.length>0){\r\n            this.card.active=true\r\n        }\r\n        var self=this\r\n        if(this.avatarUrl !=\"\" && this.avatarUrl !=null){\r\n            cc.log(\"this.avatarUrl=\",this.avatarUrl)\r\n            cc.loader.load({url:this.avatarUrl,type:'jpg'},function(err,tex){\r\n                self.icon.spriteFrame = new cc.SpriteFrame(tex);\r\n            });\r\n        }\r\n    },\r\n    \r\n    setInfo(name,score,dayingjia){\r\n        this._userName = name;\r\n        this._score = score;\r\n        if(this._score == null){\r\n            this._score = 0;\r\n        }\r\n        this._dayingjia = dayingjia;\r\n        \r\n        if(this._scoreBg != null){\r\n            this._scoreBg.active = this._score != null;            \r\n        }\r\n\r\n        if(this._lblScore != null){\r\n            this._lblScore.node.active = this._score != null;            \r\n        }\r\n\r\n        this.refresh();    \r\n    },\r\n    \r\n    \r\n    setReady:function(isReady){\r\n        this._isReady = isReady;\r\n        if(this._ready){\r\n            this._ready.active = this._isReady ; \r\n        }\r\n    },\r\n    \r\n    setID:function(id){\r\n        var idNode = this.node.getChildByName(\"id\");\r\n        if(idNode){\r\n            var lbl = idNode.getComponent(cc.Label);\r\n            lbl.string = \"ID:\" + id;            \r\n        }\r\n        \r\n        this._userId = id;\r\n        if(this._sprIcon){\r\n            this._sprIcon.setUserID(id); \r\n        }\r\n    },\r\n    \r\n    \r\n    chat:function(content){\r\n        if(this._chatBubble == null || this._emoji == null){\r\n            return;\r\n        }\r\n        this._emoji.active = false;\r\n        this._chatBubble.active = true;\r\n        this._chatBubble.getComponent(cc.Label).string = content;\r\n        this._chatBubble.getChildByName(\"New Label\").getComponent(cc.Label).string = content;\r\n        this._lastChatTime = 3;\r\n    },\r\n    \r\n    emoji:function(emoji){\r\n        //emoji = JSON.parse(emoji);\r\n        if(this._emoji == null || this._emoji == null){\r\n            return;\r\n        }\r\n        console.log(emoji);\r\n        this._chatBubble.active = false;\r\n        this._emoji.active = true;\r\n        this._emoji.getComponent(cc.Animation).play(emoji);\r\n        this._lastChatTime = 3;\r\n    },\r\n    \r\n    voiceMsg:function(show){\r\n        if(this._voicemsg){\r\n            this._voicemsg.active = show;\r\n        }\r\n    },\r\n    \r\n    refreshXuanPaiState:function(){\r\n       \r\n    },\r\n   \r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        \r\n        if(this._lastChatTime > 0){\r\n            this._lastChatTime -= dt;\r\n            if(this._lastChatTime < 0){\r\n                this._chatBubble.active = false;\r\n                this._emoji.active = false;\r\n                this._emoji.getComponent(cc.Animation).stop();\r\n            }\r\n        }\r\n    },\r\n    \r\n});\r\n"]}