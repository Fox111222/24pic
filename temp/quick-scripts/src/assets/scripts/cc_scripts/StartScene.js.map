{"version":3,"sources":["assets\\scripts\\cc_scripts\\StartScene.js"],"names":["KBEngine","require","WxBizDataCrypt","cc","Class","Component","properties","textinput_name","type","EditBox","label_hint","Label","start","sys","platform","WECHAT_GAME","getQuery","parseRoomID","nums","forEach","item","index","parseInt","qData","obj","wx","getLaunchOptionsSync","s","query","Roomid","string2Result","split","window","roomIID","UserName","invateAcountname","EditBoxclick","log","AudioMgr","playSFX","userName","string","update","dt","loginres","node","opacity","length","btn_accept","active","getChildByName","getComponent","flag","stopAllActions","action1","scaleTo","action2","repeat","repeatForever","sequence","runAction","accept_wx","localStorage","getItem","joinPrivateRoominputcallback","onLoad","initKbengine","installEvents","loader","loadRes","Prefab","err","prefab","JoinGame","instantiate","addChild","bind","btn_start","undefined","init","bgmVolume","sfxVolume","stopBGM","randomstring","code","director","preloadScene","enableWxShare","wxLoginNative","placeholder","hello","showShareMenu","data","onShareAppMessage","res","title","imageUrl","url","success","fail","self","login","setItem","sself","getUserInfo","withCredentials","encryptedData","iv","visibleSize","view","getVisibleSize","wx_size","getSystemInfoSync","size_scale_width","screenHeight","height","x","width","y","btnAuthorize","createUserInfoButton","text","style","left","top","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","uinfo","sf","console","errMsg","showToast","hide","L","randomchar","n","Math","floor","random","String","fromCharCode","args","KBEngineArgs","ip","SERVER_IP","port","SERVER_PORT","isWss","IS_USE_WSS","isByIP","LOGIN_BY_IP","serverURL","SERVER_URL","create","Event","register","unInstallEvents","deregister","onConnectionState","logStr","app","INFO_MSG","onConnectionState2","onLoginFailed","failedcode","serverErr","serverdatas","onReloginBaseappFailed","onReloginBaseappSuccessfully","onLoginBaseappFailed","decodeEncryptedData","sessionKey","pc","descrytData","onSetSpaceData","enterScene","player","loadScene","joinRoom","createPrivateRoom","joinPrivateRoom","onLoginBaseapp","Loginapp_importClientMessages","Baseapp_importClientMessages","Baseapp_importClientEntityDef","createDictString","dic","dictString","len","pro","prop","startGame","event","datas","fire","roomId"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nvar KBEngine = require(\"kbengine\");\r\nvar WxBizDataCrypt = require(\"WxBizDataCrypt\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        textinput_name:{\r\n            default: null,\r\n            type: cc.EditBox,\r\n        },\r\n\r\n        label_hint: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n    },\r\n    start()\r\n    {\r\n        if(cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            this.getQuery()\r\n        }\r\n    },\r\n    parseRoomID:function(nums){\r\n        //var str = \"\";\r\n        nums.forEach((item,index) =>{\r\n\t        nums[index] = parseInt(nums[index])\r\n        })\r\n        return nums; //转成数字数组\r\n    },\r\n    getQuery:function()\r\n        {\r\n            var qData = {};\r\n            var obj = wx.getLaunchOptionsSync();\r\n            for (var s in obj.query) //obj.query={}\r\n            {\r\n                if(s == \"Roomid\"){\r\n                    qData.Roomid = obj.query[s];\r\n                              \r\n\r\n                    var string2Result = qData.Roomid.split('') //字符串变成字符串数组\r\n                    window.roomIID=this.parseRoomID(string2Result)\r\n\r\n                    \r\n                }\r\n                if(s == \"UserName\"){\r\n                    qData.UserName = obj.query[s];\r\n                    window.invateAcountname=obj.query[s]\r\n\r\n                }\r\n\r\n            }\r\n\r\n            return qData;\r\n        },\r\n    \r\n    // LIFE-CYCLE CALLBACKS:\r\n    EditBoxclick:function(){\r\n        cc.log(\"EditBoxclick\")\r\n        window.AudioMgr.playSFX(\"ui_click\")\r\n        this.userName=this.textinput_name.string\r\n    },\r\n    update:function(dt){\r\n        //this.sum=this.sum+dt;\r\n        if(window.loginres==0){\r\n            this.label_hint.string = \"输入房间ID无效,请重新输入房号\";\r\n            this.label_hint.node.opacity=255\r\n        }\r\n        else if(window.loginres==1){\r\n            this.label_hint.string = \"房间已满！请重新输入房号\";\r\n            this.label_hint.node.opacity=255\r\n        }\r\n        //cc.log(\"roomid=\", window.roomID)\r\n        if(window.roomIID.length >0){           \r\n           this.btn_accept.active=true;\r\n           this.btn_accept.getChildByName(\"Background\").getChildByName(\"Label\").getComponent(cc.Label).string=\"确认接受\"+ window.invateAcountname +\"的邀请！\"\r\n           if(this.flag==0){\r\n            this.flag=1\r\n            this.btn_accept.stopAllActions()\r\n            var action1 = cc.scaleTo(0.5,1.2);//渐显\r\n            var action2 = cc.scaleTo(0.5,1);//渐隐效果\r\n            var repeat=cc.repeatForever(cc.sequence(action1,action2))\r\n            this.btn_accept.runAction(repeat);\r\n           }\r\n           //this.btn_start.active=false;\r\n           /*\r\n           this.btn_accept.stopAllActions()\r\n           var action1 = cc.scaleTo(0.5,1.2);//渐显\r\n           var action2 = cc.scaleTo(0.5,1);//渐隐效果\r\n           var repeat=cc.repeatForever(cc.sequence(action1,action2))\r\n           this.btn_accept.runAction(repeat);\r\n           */  \r\n        }\r\n    },\r\n    accept_wx(){\r\n        window.AudioMgr.playSFX(\"ui_click\")\r\n        this.btn_accept.active=false;\r\n        this.btn_accept.stopAllActions()\r\n        this.userName=cc.sys.localStorage.getItem(\"userName\");\r\n        this.joinPrivateRoominputcallback(window.roomIID)\r\n    },\r\n    onLoad: function () {\r\n        this.flag=0;      \r\n        this.initKbengine();\r\n        this.installEvents();\r\n        cc.loader.loadRes(\"prefab/JoinGame\", cc.Prefab, function (err, prefab) {\r\n            if (err) {\r\n                cc.log(\"cc.loader.loadRes fail\")\r\n                return;\r\n            }\r\n            //cc.log(\"cc.loader.loadRes success\")\r\n            this.JoinGame = cc.instantiate(prefab);\r\n            this.JoinGame.active=false\r\n            this.node.getChildByName(\"start_bg\").addChild(this.JoinGame)\r\n//                this.FlyPoolDict[this.FlyPoolid]=newNode\r\n//                this.FlyPoolid++;\r\n        }.bind(this));\r\n        \r\n        this.btn_start=this.node.getChildByName(\"start_bg\").getChildByName(\"btn_start\")\r\n\r\n        this.btn_accept=this.node.getChildByName(\"start_bg\").getChildByName(\"accept\")\r\n        this.btn_accept.active=false;\r\n        this.btn_accept.stopAllActions()\r\n\r\n        \r\n        //this.loadItemPrefab();\r\n        //window.AudioMgr=this.node.addComponent(\"AudioMgr\")\r\n        if(window.AudioMgr==undefined){\r\n            var AudioMgr = require(\"AudioMgr\");\r\n            window.AudioMgr = new AudioMgr();\r\n            window.AudioMgr.init();\r\n            window.AudioMgr.bgmVolume=0.5\r\n            window.AudioMgr.sfxVolume=0.5\r\n        }\r\n\r\n        window.AudioMgr.stopBGM()\r\n        this.userName = cc.sys.platform != cc.sys.WECHAT_GAME ? this.randomstring(4): '';\r\n        //this.btn_start.node.on('click', this.startGame, this);\r\n        this.code = \"\";\r\n        \r\n        cc.director.preloadScene(\"WorldScene\");\r\n\r\n        if(cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            this.btn_start.active = false;\r\n            this.textinput_name.node.active = false;\r\n            this.enableWxShare();\r\n            this.wxLoginNative();\r\n            //window.wc=true;\r\n        } else {\r\n            this.textinput_name.placeholder=\"请输入你的昵称...\"\r\n            this.userName=this.textinput_name.string         \r\n        }\r\n        //window.AudioMgr.playBGM(\"bgm\")\r\n        cc.log(\"window.loginres=\",window.loginres)\r\n\r\n\r\n     },\r\n\r\n     hello () {\r\n        cc.log(\"hello world\");\r\n     },\r\n\r\n\r\n     enableWxShare: function () {\r\n        wx.showShareMenu();\r\n\r\n        cc.loader.loadRes(\"sound/share\",function(err,data){\r\n           // wx.shareAppMessage({   //打开小游戏自动分享\r\n           wx.onShareAppMessage(function(res){\r\n               return{\r\n                title: \"24点 智力小PK\",\r\n                imageUrl: data.url,\r\n                //query: \"Roomid=\" + self.roomKeyc + \"&UserName=\" + KBEngine.app.entities[KBEngine.app.player().id].accountName,// 别人点击链接时会得到的数据\r\n                //query: \"nick=\" + nick + \"&gender=\" + gender + \"&city=\" + city,\r\n                //query:\"Roomid=\"+ self.roomKeyc+\"&UserName=\"+ KBEngine.app.entities[KBEngine.app.player().id].accountName,\r\n                success(res) {               \r\n                   \r\n                    \r\n                    cc.log(\"分享成功\" + res);\r\n                    //this.yaoqing.active=false                      \r\n                },\r\n                fail(res) {\r\n                    cc.log(\"分享失败\" + res);\r\n                    //this.yaoqing.active=true\r\n                }\r\n            }\r\n                \r\n            });\r\n        });\r\n     },\r\n\r\n    wxLoginNative: function(){\r\n       this.btn_start.active = true;\r\n        var self=this;\r\n        wx.login({\r\n            success: (res) => {\r\n                if(res.code) {\r\n                    //sself.code = res.code;\r\n                    cc.sys.localStorage.setItem(\"userName\", res.code);\r\n                    cc.log(\"wxLoginNative success\")\r\n                    var sself=self;\r\n                    \r\n                    //在用户未授权过的情况下调用此接口，将不再出现授权弹窗，会直接进入 fail 回调\r\n                    wx.getUserInfo({\r\n                        withCredentials:1,\r\n                        success: (res) => {\r\n                            sself.btn_start.active = true;\r\n                            //sself.userName = this.code;                            \r\n                            cc.sys.localStorage.setItem(\"encryptedData\", res.encryptedData);\r\n                            cc.sys.localStorage.setItem(\"iv\", res.iv);\r\n                            cc.log(\"wxLoginNative() encryptedData && iv\",res.encryptedData , res.iv)\r\n                        },\r\n                        fail:(res)=>{\r\n                            cc.log(\"wx.getuserinfo fail\")\r\n                                //获取视图窗口可见区域尺寸\r\n                            let visibleSize = cc.view.getVisibleSize(); \r\n                            //获取系统信息\r\n                            let wx_size = wx.getSystemInfoSync();\r\n                            //计算实际大小和可见区域尺寸的比例（这里以宽度为准）\r\n                            let size_scale_width = wx_size.screenHeight / visibleSize.height;\r\n                            let x = (visibleSize.width / 2) * size_scale_width-(125 * size_scale_width);\r\n                            let y = ( visibleSize.height / 2 ) * size_scale_width;\r\n                            let width = 250 * size_scale_width;\r\n                            let height = 60 * size_scale_width;\r\n                            sself.btnAuthorize = wx.createUserInfoButton({\r\n                                type: 'text',\r\n                                text: '点击微信登陆授权',\r\n                                style: {\r\n                                    left: x,\r\n                                    top: y,\r\n                                    width: width,\r\n                                    height: height,\r\n                                    lineHeight: height,\r\n                                    backgroundColor: \"#ffffff\",\r\n                                    color: \"#3296fa\",\r\n                                    textAlign: \"center\",\r\n                                    fontSize: 16,\r\n                                    borderRadius: 0,\r\n                                }\r\n                            })\r\n                    \r\n                            sself.btnAuthorize.onTap((uinfo) => {\r\n                                var sf=sself\r\n                                console.log(\"onTap uinfo: \",uinfo);\r\n                                if (uinfo.errMsg == \"getUserInfo:ok\") {\r\n                                    console.log(\"wxLogin auth success\");\r\n                                    wx.showToast({title:\"授权成功\"});\r\n                                    cc.sys.localStorage.setItem(\"encryptedData\", uinfo.encryptedData);\r\n                                    cc.sys.localStorage.setItem(\"iv\", uinfo.iv);\r\n                                    //sf.label_hint.string = \"uinfo.encryptedData=\"+uinfo.encryptedData+\"/\"+uinfo.iv;\r\n                                    sf.label_hint.string = uinfo.encryptedData ;\r\n                                    sf.btn_start.active = true;\r\n                                }else {\r\n                                    console.log(\"wxLogin auth fail\");\r\n                                    wx.showToast({title:\"授权失败\"});\r\n                                }\r\n                                sf.btnAuthorize.hide(); //获取用户信息成功后隐藏按钮\r\n                            });\r\n\r\n                        },\r\n                    });     \r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n     randomstring: function(L){\r\n        var s= '';\r\n        var randomchar=function(){\r\n         var n= Math.floor(Math.random()*62);\r\n         if(n<10) return n; //0-9\r\n         if(n<36) return String.fromCharCode(n+55); //A-Z\r\n         return String.fromCharCode(n+61); //a-z\r\n        }\r\n        while(s.length< L) s+= randomchar();\r\n        return s;\r\n    },\r\n\r\n\r\n     initKbengine: function() {\r\n        var args = new KBEngine.KBEngineArgs();\t\r\n\t    args.ip = SERVER_IP;\r\n        args.port = SERVER_PORT;\r\n        args.isWss = IS_USE_WSS;              //是否用wss协议， true:wss  false:ws\r\n        args.isByIP = LOGIN_BY_IP;             //用ip还是用域名登录服务器   有修改官方的kbengine.js\r\n        args.serverURL = SERVER_URL;\r\n\t    KBEngine.create(args);\r\n     },\r\n\r\n     installEvents:function() {\r\n        KBEngine.Event.register(\"onConnectionState\", this, \"onConnectionState\");\r\n        KBEngine.Event.register(\"onConnectionState2\", this, \"onConnectionState2\");\r\n        KBEngine.Event.register(\"onLoginFailed\", this, \"onLoginFailed\");\r\n        KBEngine.Event.register(\"onLoginBaseappFailed\", this, \"onLoginBaseappFailed\");\r\n\t\tKBEngine.Event.register(\"enterScene\", this, \"enterScene\");\r\n        KBEngine.Event.register(\"onReloginBaseappFailed\", this, \"onReloginBaseappFailed\");\r\n        KBEngine.Event.register(\"onReloginBaseappSuccessfully\", this, \"onReloginBaseappSuccessfully\");\r\n        KBEngine.Event.register(\"onLoginBaseapp\", this, \"onLoginBaseapp\");\r\n        KBEngine.Event.register(\"onSetSpaceData\", this, \"onSetSpaceData\");\r\n        \r\n     },\r\n\r\n     unInstallEvents() {\r\n        KBEngine.Event.deregister(\"onConnectionState\", this, \"onConnectionState\");\r\n        KBEngine.Event.deregister(\"onConnectionState2\", this, \"onConnectionState2\");\r\n        KBEngine.Event.deregister(\"onLoginFailed\", this, \"onLoginFailed\");\r\n        KBEngine.Event.deregister(\"onLoginBaseappFailed\", this, \"onLoginBaseappFailed\");\r\n\t\tKBEngine.Event.deregister(\"enterScene\", this, \"enterScene\");\r\n        KBEngine.Event.deregister(\"onReloginBaseappFailed\", this, \"onReloginBaseappFailed\");\r\n        KBEngine.Event.deregister(\"onReloginBaseappSuccessfully\", this, \"onReloginBaseappSuccessfully\");\r\n        KBEngine.Event.deregister(\"onLoginBaseapp\", this, \"onLoginBaseapp\");\r\n        KBEngine.Event.deregister(\"onSetSpaceData\", this, \"onSetSpaceData\");\r\n        \r\n     },\r\n\r\n     onConnectionState : function(success) {\r\n        var logStr = \"\";\r\n\t\tif(!success) {\r\n            logStr = \" Connect(\" + KBEngine.app.ip + \":\" + KBEngine.app.port + \") is error! (连接错误)\";\r\n            this.btn_start.active = true;\r\n            this.label_hint.string = \"连接错误onerror_before_onopen\";\r\n        }\r\n\t\telse {\r\n            logStr = \"Connect successfully, please wait...(连接成功，请等候...)\";\r\n        }\r\n     \r\n        KBEngine.INFO_MSG(logStr);\r\n    },\r\n    onConnectionState2 : function(success) {\r\n        var logStr = \"\";\r\n\t\tif(!success) {\r\n            logStr = \" Connect(\" + KBEngine.app.ip + \":\" + KBEngine.app.port + \") is error! (连接错误)\";\r\n            this.btn_start.active = true;\r\n            this.label_hint.string = \"连接错误socket not is null\";\r\n        }\r\n\t\telse {\r\n            logStr = \"Connect successfully, please wait...(连接成功，请等候...)\";\r\n        }\r\n     \r\n        KBEngine.INFO_MSG(logStr);\r\n\t},\r\n\r\n     onLoginFailed : function(failedcode) {\r\n        var logStr = '';\r\n        if(failedcode == 20)\r\n        {\r\n           logStr = \"Login is failed(登陆失败), err=\" + KBEngine.app.serverErr(failedcode) + \", \" + KBEngine.app.serverdatas;\r\n        }\r\n        else\r\n        {\r\n           logStr = \"Login is failed(登陆失败), err=\" + KBEngine.app.serverErr(failedcode);\r\n        }    \r\n        \r\n        this.label_hint.string = \"登陆失败,\" +  KBEngine.app.serverErr(failedcode);\r\n        this.btn_start.active = true;\r\n        KBEngine.INFO_MSG(logStr);\t\r\n     },\r\n\r\n     onReloginBaseappFailed: function(failedcode){\r\n        this.btn_start.active = true;\r\n        KBEngine.INFO_MSG(\"reogin is failed(断线重连失败), err=\" + KBEngine.app.serverErr(failedcode))\r\n     },\r\n\r\n     onReloginBaseappSuccessfully : function() {\r\n        KBEngine.INFO_MSG(\"reogin is successfully!(断线重连成功!)\")\r\n    },\r\n\r\n     onLoginBaseappFailed : function(failedcode) {\r\n        this.btn_start.active = true;\r\n        KBEngine.INFO_MSG(\"LoginBaseapp is failed(登陆网关失败), err=\" + KBEngine.app.serverErr(failedcode));\r\n     },\r\n\r\n     decodeEncryptedData:function() {\r\n        var encryptedData = cc.sys.localStorage.getItem(\"encryptedData\");\r\n        var sessionKey = cc.sys.localStorage.getItem(\"sessionKey\");\r\n        var iv = cc.sys.localStorage.getItem(\"iv\");\r\n        KBEngine.INFO_MSG(\"decodeEncryptedData: encryptedData=\" + encryptedData + \" ,iv=\" + iv + \" ,sessionKey=\" + sessionKey);\r\n        if(sessionKey && encryptedData && iv) {\r\n            //var pc = new WxBizDataCrypt(APPID, sessionKey);\r\n            var pc = new WxBizDataCrypt(\"wxbe1644556ed8afa6\", \"96c0e22af25571db5f175ebbb550e672\");\r\n            var data = pc.descrytData(encryptedData , iv);\r\n            console.log('解密后 data: ', data)\r\n        }\r\n     },\r\n     onSetSpaceData:function(){\r\n         cc.log(\"startscene.onSetSpaceData\")\r\n     },  \r\n     enterScene : function() {\r\n        KBEngine.INFO_MSG(\"Login is successfully!(登陆成功!)\");\r\n        this.label_hint.string = \"登陆成功 !!!\";\r\n        if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n            var player = KBEngine.app.player();\r\n            var encryptedData = cc.sys.localStorage.getItem(\"encryptedData\");\r\n            var iv = cc.sys.localStorage.getItem(\"iv\");\r\n            cc.log(\"encryptedData && iv\",encryptedData , iv)\r\n            this.label_hint.string = \"base.decodeEncryptedData()=\" + encryptedData + \"/\" + iv;\r\n            player.decodeEncryptedData();\r\n        } \r\n        //var player = KBEngine.app.player();//KBEngine.app.entities[KBEngine.app.entity_id];    \r\n        //player.joinRoom()\r\n\r\n        cc.director.loadScene(\"WorldScene\", ()=> {\r\n            KBEngine.INFO_MSG(\"load world scene finished\");\r\n            var player = KBEngine.app.player();//KBEngine.app.entities[KBEngine.app.entity_id];\r\n            //window.type=1\r\n            if(player){\r\n                if (window.type==1){\r\n                    player.joinRoom();\r\n                }\r\n                if (window.type==2){\r\n                    player.createPrivateRoom();\r\n                    \r\n                }\r\n                if (window.type==3 && window.roomIID.length>0){\r\n                    player.joinPrivateRoom(window.roomIID);               \r\n                }                \r\n            }\r\n            window.roomIID=[]\r\n            this.unInstallEvents();           \r\n        });\r\n     },\r\n \r\n     onLoginBaseapp : function() {\r\n        cc.log(\"Connect to loginBaseapp, please wait...(连接到网关， 请稍后...)\");\r\n     },\r\n \r\n     Loginapp_importClientMessages : function() {\r\n        this.label_hint.string = \"登陆中 ... ...\";\r\n        cc.log(\"Loginapp_importClientMessages ...\");\r\n     },\r\n \r\n     Baseapp_importClientMessages : function() {\r\n         cc.log(\"Baseapp_importClientMessages ..\");\r\n     },\r\n         \r\n     Baseapp_importClientEntityDef: function() {\r\n         cc.log(\"Baseapp_importClientEntityDef ..\")\r\n     },\r\n\r\n     createDictString: function(dic) {\r\n        var dictString = \"\";\r\n        var len = 0;\r\n        for(var pro in dic) len++;\r\n\r\n        if(len > 0) {\r\n            var index = 0;\r\n            var dictString = \"{\"\r\n            for(var prop in dic) {\r\n                dictString += \"'\" + prop + \"'\" ;\r\n                dictString += \":\";\r\n                dictString += \"'\" + dic[prop] + \"'\";\r\n                if(index == len-1) {\r\n                    dictString += \"}\";\r\n                }else {\r\n                    dictString += \",\";\r\n                }\r\n                index++;\r\n            }\r\n        }\r\n\r\n        return dictString;\r\n     },\r\n \r\n     startGame: function (event) {\r\n        window.loginres=100;\r\n        window.AudioMgr.playSFX(\"ui_click\")\r\n         //cc.log(\"cc.sys.platform\",cc.sys.platform,cc.sys.WECHAT_GAME)\r\n         window.type=1\r\n         if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n             this.userName=cc.sys.localStorage.getItem(\"userName\");\r\n         }\r\n         if(this.userName.length == 0)\r\n         {\r\n             this.label_hint.string = \"用户名不能为空\";\r\n             return;\r\n         }\r\n         cc.log(\"this.userName=\", this.userName)  \r\n         var datas = {};\r\n         datas[\"platform\"] = cc.sys.platform;\r\n         datas = this.createDictString(datas);\r\n         KBEngine.INFO_MSG(\"login name=\" + this.userName);\r\n         KBEngine.Event.fire(\"login\", this.userName, \"123456\", datas);  \r\n         this.label_hint.string = \"登陆中 ... ...\";\r\n         this.btn_start.active = false;\r\n \r\n      },\r\n      createPrivateRoom: function (event) {\r\n          window.loginres=100; \r\n          window.type=2\r\n          window.AudioMgr.playSFX(\"ui_click\")\r\n          //cc.log(\"cc.sys.platform\",cc.sys.platform,cc.sys.WECHAT_GAME)\r\n          if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n              this.userName=cc.sys.localStorage.getItem(\"userName\");\r\n          }\r\n          if(this.userName.length == 0)\r\n          {\r\n              this.label_hint.string = \"用户名不能为空\";\r\n              return;\r\n          }\r\n          cc.log(\"this.userName=\",this.userName)  \r\n          var datas = {};\r\n          datas[\"platform\"] = cc.sys.platform;\r\n          datas = this.createDictString(datas);\r\n          KBEngine.INFO_MSG(\"login name=\" + this.userName);\r\n          //var temp1=UnicodeToUtf8(this.userName)\r\n          //this.userName =java.net.URLDecoder.decode(temp,\"UTF-8\"); \r\n          //this.userName =Utf8ToUnicode(temp1)\r\n          //cc.log(\"this.userName=\",this.userName)  \r\n          KBEngine.Event.fire(\"login\", this.userName, \"123456\", datas);  \r\n          this.label_hint.string = \"登陆中 ... ...\";\r\n          this.btn_start.active = false;\r\n       },\r\n       joinPrivateRoominputcallback:function(roomId){ //参数是数组\r\n         window.type=3\r\n         window.loginres=100;\r\n         window.roomIID=roomId\r\n         if(this.JoinGame)\r\n            this.JoinGame.active=false\r\n           //////////////////////////////////////////////////\r\n          cc.log(\"this.userName=\",this.userName,roomId)  \r\n          var datas = {};\r\n          datas[\"platform\"] = cc.sys.platform;\r\n          datas = this.createDictString(datas);\r\n          KBEngine.INFO_MSG(\"login name=\" + this.userName);\r\n \r\n          KBEngine.Event.fire(\"login\", this.userName, \"123456\", datas);  \r\n          this.label_hint.string = \"登陆中 ... ...\";\r\n          this.btn_start.active = false;\r\n \r\n       },\r\n       joinPrivateRoom: function (event) {\r\n         \r\n         window.AudioMgr.playSFX(\"ui_click\")\r\n          //cc.log(\"cc.sys.platform\",cc.sys.platform,cc.sys.WECHAT_GAME)\r\n \r\n          \r\n          if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n              this.userName=cc.sys.localStorage.getItem(\"userName\");\r\n          }\r\n          if(this.userName.length == 0)\r\n          {\r\n              this.label_hint.string = \"用户名不能为空\";\r\n              return;\r\n          }\r\n          this.JoinGame.active=true\r\n          ///////////////////////////////////////////////////\r\n  \r\n  \r\n          \r\n       },\r\n\r\n\r\n\r\n});\r\n"]}