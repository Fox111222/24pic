{"version":3,"sources":["assets\\scripts\\cc_scripts\\eval2.js"],"names":["isOperator","value","operatorString","indexOf","getPrioraty","prioraty","o1","o2","dal2Rpn","exp","inputStack","outputStack","outputQueue","res","i","len","length","cur","push","shift","po","pop","Number","evalRpn","rpnQueue","sec","fir","getResult","first","second","operator","result","formatFloat","f","digit","m","Math","pow","parseInt","window","eval2"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nfunction isOperator(value) {\r\n    var operatorString = \"+-*/()\";\r\n    return operatorString.indexOf(value) > -1\r\n}\r\n \r\nfunction getPrioraty(value) {\r\n    switch (value) {\r\n        case '+':\r\n        case '-':\r\n            return 1;\r\n        case '*':\r\n        case '/':\r\n            return 2;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n \r\nfunction prioraty(o1, o2) {\r\n    return getPrioraty(o1) <= getPrioraty(o2);\r\n}\r\n \r\nfunction dal2Rpn(exp) {\r\n  var inputStack = [];\r\n    var outputStack = [];\r\n    var outputQueue = [];\r\n    let res = '';\r\n    for (var i = 0, len = exp.length; i < len; i++) {\r\n      var cur = exp[i];\r\n      if (cur != ' ') {\r\n        res = res + cur;\r\n        if (i + 1 < exp.length) {\r\n          if (isOperator(exp[i])) {\r\n            inputStack.push(res);\r\n            res = ''\r\n          } else {\r\n            if (isOperator(exp[i + 1])) {\r\n              inputStack.push(res);\r\n              res = ''\r\n            }\r\n          }\r\n        } else {\r\n          inputStack.push(res);\r\n          res = ''\r\n        }\r\n      }\r\n    }\r\n \r\n    while (inputStack.length > 0) {\r\n        var cur = inputStack.shift();\r\n        if (isOperator(cur)) {\r\n            if (cur == '(') {\r\n                outputStack.push(cur);\r\n            } else if (cur == ')') {\r\n                var po = outputStack.pop();\r\n                while (po != '(' && outputStack.length > 0) {\r\n                    outputQueue.push(po);\r\n                    po = outputStack.pop();\r\n                }\r\n                if (po != '(') {\r\n                    throw \"error: unmatched ()\";\r\n                }\r\n            } else {\r\n                while (prioraty(cur, outputStack[outputStack.length - 1]) && outputStack.length > 0) {\r\n                    outputQueue.push(outputStack.pop());\r\n                }\r\n                outputStack.push(cur);\r\n            }\r\n        } else {\r\n            outputQueue.push(new Number(cur));\r\n        }\r\n    }\r\n \r\n    if (outputStack.length > 0) {\r\n        if (outputStack[outputStack.length - 1] == ')' || outputStack[outputStack.length - 1] == '(') {\r\n            throw \"error: unmatched ()\";\r\n        }\r\n        while (outputStack.length > 0) {\r\n            outputQueue.push(outputStack.pop());\r\n        }\r\n    }\r\n \r\n    return outputQueue;\r\n \r\n}\r\nfunction evalRpn(rpnQueue) {\r\n    var outputStack = [];\r\n    while (rpnQueue.length > 0) {\r\n        var cur = rpnQueue.shift();\r\n \r\n        if (!isOperator(cur)) {\r\n            outputStack.push(cur);\r\n        } else {\r\n            if (outputStack.length < 2) {\r\n                throw \"unvalid stack length\";\r\n            }\r\n            var sec = outputStack.pop();\r\n            var fir = outputStack.pop();\r\n \r\n            outputStack.push(getResult(fir, sec, cur));\r\n        }\r\n    }\r\n    if (outputStack.length != 1) {\r\n        throw \"unvalid expression\";\r\n    } else {\r\n        return outputStack[0];\r\n    }\r\n}\r\nfunction getResult(first, second, operator) {\r\n    var result = 0;\r\n    switch (operator) {\r\n        case '+':\r\n            result = first + second;\r\n            break;\r\n        case '-':\r\n            result = first - second;\r\n            break;\r\n        case '*':\r\n            result = first * second;\r\n            break;\r\n        case '/':\r\n            result = first / second;\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n \r\n    //浮点数的小数位超过两位时，只保留两位小数点\r\n    function formatFloat(f, digit) {\r\n        //pow(10,n) 为 10 的 n 次方\r\n        var m = Math.pow(10, digit);\r\n        return parseInt(f * m, 10) / m;\r\n    }\r\n    return (formatFloat(result, 2));\r\n}\r\n//console.log(evalRpn(dal2Rpn('3 *4 +5+7')));\r\nwindow.eval2=function(exp){\r\n    return evalRpn(dal2Rpn(exp))\r\n}"]}