{"version":3,"sources":["assets\\scripts\\Settings.js"],"names":["KBEngine","require","cc","Class","Component","properties","_btnYXOpen","type","Node","_btnYXClose","_btnYYOpen","_btnYYClose","onBgClicked","event","stopPropagation","onLoad","window","AudioMgr","log","node","getChildByName","refreshVolume","onSlided","slider","parent","name","setSFXVolume","progress","setBGMVolume","initButtonHandler","btn","addClickEvent","active","sfxVolume","yx","width","getComponent","Slider","scaleX","bgmVolume","yy","onBtnClicked","playSFX","target","sys","localStorage","removeItem","director","loadScene","player","app","leaverequest","unInstallEvents"],"mappings":"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","sourceRoot":"/","sourcesContent":["var KBEngine = require(\"kbengine\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n    \r\n    properties: {\r\n        _btnYXOpen:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        _btnYXClose:{\r\n            type:cc.Node,\r\n            default:null,\r\n        },\r\n        _btnYYOpen:{\r\n            type:cc.Node,\r\n            default:null,\r\n        },\r\n        _btnYYClose:{\r\n            type:cc.Node,\r\n            default:null,\r\n        },\r\n    },\r\n    /*\r\n    addClickEvent:function(node,target,component,handler){\r\n        cc.log(component + \":\" + handler);\r\n        var eventHandler = new cc.Component.EventHandler();\r\n        eventHandler.target = target;\r\n        eventHandler.component = component;\r\n        eventHandler.handler = handler;\r\n\r\n        var clickEvents = node.getComponent(cc.Button).clickEvents;\r\n        clickEvents.push(eventHandler);\r\n    },\r\n    \r\n    addSlideEvent:function(node,target,component,handler){\r\n        var eventHandler = new cc.Component.EventHandler();\r\n        eventHandler.target = target;\r\n        eventHandler.component = component;\r\n        eventHandler.handler = handler;\r\n\r\n        var slideEvents = node.getComponent(cc.Slider).slideEvents;\r\n        slideEvents.push(eventHandler);\r\n    },\r\n    */\r\n    // use this for initialization\r\n    onBgClicked:function(event){\r\n        event.stopPropagation()\r\n    },\r\n    onLoad: function () {\r\n        if(window.AudioMgr== null){\r\n            cc.log(\"window.AudioMgr== null\")\r\n            return;\r\n        }               \r\n  \r\n        this._btnYXOpen = this.node.getChildByName(\"yinxiao\").getChildByName(\"btn_yx_open\");\r\n        this._btnYXClose = this.node.getChildByName(\"yinxiao\").getChildByName(\"btn_yx_close\");\r\n        this._btnYYOpen = this.node.getChildByName(\"yinyue\").getChildByName(\"btn_yy_open\");\r\n        this._btnYYClose = this.node.getChildByName(\"yinyue\").getChildByName(\"btn_yy_close\");\r\n      \r\n        this.refreshVolume();\r\n    },\r\n    \r\n    onSlided:function(slider){\r\n        if(slider.node.parent.name == \"yinxiao\"){\r\n            window.AudioMgr.setSFXVolume(slider.progress);\r\n        }\r\n        else if(slider.node.parent.name == \"yinyue\"){\r\n            window.AudioMgr.setBGMVolume(slider.progress);\r\n        }\r\n        this.refreshVolume();\r\n    },\r\n    \r\n    initButtonHandler:function(btn){\r\n        this.addClickEvent(btn,this.node,\"Settings\",\"onBtnClicked\");    \r\n    },\r\n\r\n    refreshVolume:function(){\r\n        \r\n        this._btnYXClose.active = window.AudioMgr.sfxVolume > 0;\r\n        this._btnYXOpen.active = !this._btnYXClose.active;\r\n        \r\n        var yx = this.node.getChildByName(\"yinxiao\");\r\n        var width = 430 * window.AudioMgr.sfxVolume;\r\n        var progress = yx.getChildByName(\"progress\")\r\n        progress.getComponent(cc.Slider).progress = window.AudioMgr.sfxVolume;\r\n        //progress.getChildByName(\"progress\").width = width; \r\n        progress.getChildByName(\"progress\").scaleX =window.AudioMgr.sfxVolume; \r\n         \r\n        //yx.getChildByName(\"btn_progress\").x = progress.x + width;\r\n        \r\n        \r\n        this._btnYYClose.active = window.AudioMgr.bgmVolume > 0;\r\n        this._btnYYOpen.active = !this._btnYYClose.active;\r\n        var yy = this.node.getChildByName(\"yinyue\");\r\n        var width = 430 * window.AudioMgr.bgmVolume;\r\n        var progress = yy.getChildByName(\"progress\");\r\n        progress.getComponent(cc.Slider).progress =window.AudioMgr.bgmVolume; \r\n        \r\n        //progress.getChildByName(\"progress\").width = width;\r\n        progress.getChildByName(\"progress\").scaleX = window.AudioMgr.bgmVolume;\r\n        //yy.getChildByName(\"btn_progress\").x = progress.x + width;\r\n    },\r\n    \r\n    onBtnClicked:function(event){\r\n        window.AudioMgr.playSFX(\"ui_click\")\r\n        //cc.log(\"onBtnClicked\",event.target.name)\r\n        if(event.target.name == \"btn_close\"){\r\n            this.node.active = false;\r\n            \r\n        }\r\n        else if(event.target.name == \"btn_exit\"){\r\n            cc.sys.localStorage.removeItem(\"wx_account\");\r\n            cc.sys.localStorage.removeItem(\"wx_sign\");\r\n\r\n            //var player = KBEngine.app.player();\r\n            //if(player){\r\n            //    player.leaverequest()\r\n            //}\r\n            \r\n            cc.director.loadScene(\"StartScene\", () => {\r\n                //window.loginres=num\r\n                var player = KBEngine.app.player();\r\n                if(player){\r\n                    player.leaverequest()\r\n                }\r\n                cc.log(\"startscene===>wordscene\")\r\n            });\r\n            //cc.director.loadScene(\"StartScene\");\r\n            this.node.parent.getComponent(\"WorldScene\").unInstallEvents();\r\n            \r\n        }\r\n        else if(event.target.name == \"btn_yx_open\"){\r\n            window.AudioMgr.setSFXVolume(1.0);\r\n            this.refreshVolume(); \r\n        }\r\n        else if(event.target.name == \"btn_yx_close\"){\r\n            window.AudioMgr.setSFXVolume(0);\r\n            this.refreshVolume();\r\n        }\r\n        else if(event.target.name == \"btn_yy_open\"){\r\n            window.AudioMgr.setBGMVolume(1);\r\n            this.refreshVolume();\r\n        }\r\n        else if(event.target.name == \"btn_yy_close\"){\r\n            window.AudioMgr.setBGMVolume(0);\r\n            this.refreshVolume();\r\n        }\r\n    }\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}