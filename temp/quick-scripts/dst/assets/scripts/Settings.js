
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Settings.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '35e49hR44JEyKXMPDq4jIGZ', 'Settings');
// Settings.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    _btnYXOpen: {
      "default": null,
      type: cc.Node
    },
    _btnYXClose: {
      type: cc.Node,
      "default": null
    },
    _btnYYOpen: {
      type: cc.Node,
      "default": null
    },
    _btnYYClose: {
      type: cc.Node,
      "default": null
    }
  },
  addClickEvent: function addClickEvent(node, target, component, handler) {
    cc.log(component + ":" + handler);
    var eventHandler = new cc.Component.EventHandler();
    eventHandler.target = target;
    eventHandler.component = component;
    eventHandler.handler = handler;
    var clickEvents = node.getComponent(cc.Button).clickEvents;
    clickEvents.push(eventHandler);
  },
  addSlideEvent: function addSlideEvent(node, target, component, handler) {
    var eventHandler = new cc.Component.EventHandler();
    eventHandler.target = target;
    eventHandler.component = component;
    eventHandler.handler = handler;
    var slideEvents = node.getComponent(cc.Slider).slideEvents;
    slideEvents.push(eventHandler);
  },
  // use this for initialization
  onLoad: function onLoad() {
    if (window.AudioMgr == null) {
      cc.log("window.AudioMgr== null");
      return;
    }

    this._btnYXOpen = this.node.getChildByName("yinxiao").getChildByName("btn_yx_open");
    this._btnYXClose = this.node.getChildByName("yinxiao").getChildByName("btn_yx_close");
    this._btnYYOpen = this.node.getChildByName("yinyue").getChildByName("btn_yy_open");
    this._btnYYClose = this.node.getChildByName("yinyue").getChildByName("btn_yy_close");
    this.initButtonHandler(this.node.getChildByName("btn_close"));
    this.initButtonHandler(this.node.getChildByName("btn_exit"));
    this.initButtonHandler(this._btnYXOpen);
    this.initButtonHandler(this._btnYXClose);
    this.initButtonHandler(this._btnYYOpen);
    this.initButtonHandler(this._btnYYClose);
    var slider = this.node.getChildByName("yinxiao").getChildByName("progress");
    this.addSlideEvent(slider, this.node, "Settings", "onSlided");
    var slider = this.node.getChildByName("yinyue").getChildByName("progress");
    this.addSlideEvent(slider, this.node, "Settings", "onSlided");
    this.refreshVolume();
  },
  onSlided: function onSlided(slider) {
    if (slider.node.parent.name == "yinxiao") {
      window.AudioMgr.setSFXVolume(slider.progress);
    } else if (slider.node.parent.name == "yinyue") {
      window.AudioMgr.setBGMVolume(slider.progress);
    }

    this.refreshVolume();
  },
  initButtonHandler: function initButtonHandler(btn) {
    this.addClickEvent(btn, this.node, "Settings", "onBtnClicked");
  },
  refreshVolume: function refreshVolume() {
    this._btnYXClose.active = window.AudioMgr.sfxVolume > 0;
    this._btnYXOpen.active = !this._btnYXClose.active;
    var yx = this.node.getChildByName("yinxiao");
    var width = 430 * window.AudioMgr.sfxVolume;
    var progress = yx.getChildByName("progress");
    progress.getComponent(cc.Slider).progress = window.AudioMgr.sfxVolume;
    progress.getChildByName("progress").width = width; //yx.getChildByName("btn_progress").x = progress.x + width;

    this._btnYYClose.active = window.AudioMgr.bgmVolume > 0;
    this._btnYYOpen.active = !this._btnYYClose.active;
    var yy = this.node.getChildByName("yinyue");
    var width = 430 * window.AudioMgr.bgmVolume;
    var progress = yy.getChildByName("progress");
    progress.getComponent(cc.Slider).progress = window.AudioMgr.bgmVolume;
    progress.getChildByName("progress").width = width; //yy.getChildByName("btn_progress").x = progress.x + width;
  },
  onBtnClicked: function onBtnClicked(event) {
    window.AudioMgr.playSFX("ui_click");
    cc.log("onBtnClicked", event.target.name);

    if (event.target.name == "btn_close") {
      this.node.active = false;
    } else if (event.target.name == "btn_exit") {
      cc.sys.localStorage.removeItem("wx_account");
      cc.sys.localStorage.removeItem("wx_sign");
      cc.director.loadScene("StartScene");
    } else if (event.target.name == "btn_yx_open") {
      window.AudioMgr.setSFXVolume(1.0);
      this.refreshVolume();
    } else if (event.target.name == "btn_yx_close") {
      window.AudioMgr.setSFXVolume(0);
      this.refreshVolume();
    } else if (event.target.name == "btn_yy_open") {
      window.AudioMgr.setBGMVolume(1);
      this.refreshVolume();
    } else if (event.target.name == "btn_yy_close") {
      window.AudioMgr.setBGMVolume(0);
      this.refreshVolume();
    }
  } // called every frame, uncomment this function to activate update callback
  // update: function (dt) {
  // },

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2V0dGluZ3MuanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJfYnRuWVhPcGVuIiwidHlwZSIsIk5vZGUiLCJfYnRuWVhDbG9zZSIsIl9idG5ZWU9wZW4iLCJfYnRuWVlDbG9zZSIsImFkZENsaWNrRXZlbnQiLCJub2RlIiwidGFyZ2V0IiwiY29tcG9uZW50IiwiaGFuZGxlciIsImxvZyIsImV2ZW50SGFuZGxlciIsIkV2ZW50SGFuZGxlciIsImNsaWNrRXZlbnRzIiwiZ2V0Q29tcG9uZW50IiwiQnV0dG9uIiwicHVzaCIsImFkZFNsaWRlRXZlbnQiLCJzbGlkZUV2ZW50cyIsIlNsaWRlciIsIm9uTG9hZCIsIndpbmRvdyIsIkF1ZGlvTWdyIiwiZ2V0Q2hpbGRCeU5hbWUiLCJpbml0QnV0dG9uSGFuZGxlciIsInNsaWRlciIsInJlZnJlc2hWb2x1bWUiLCJvblNsaWRlZCIsInBhcmVudCIsIm5hbWUiLCJzZXRTRlhWb2x1bWUiLCJwcm9ncmVzcyIsInNldEJHTVZvbHVtZSIsImJ0biIsImFjdGl2ZSIsInNmeFZvbHVtZSIsInl4Iiwid2lkdGgiLCJiZ21Wb2x1bWUiLCJ5eSIsIm9uQnRuQ2xpY2tlZCIsImV2ZW50IiwicGxheVNGWCIsInN5cyIsImxvY2FsU3RvcmFnZSIsInJlbW92ZUl0ZW0iLCJkaXJlY3RvciIsImxvYWRTY2VuZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFFTEMsRUFBQUEsVUFBVSxFQUFFO0FBRVJDLElBQUFBLFVBQVUsRUFBQztBQUNQLGlCQUFRLElBREQ7QUFFUEMsTUFBQUEsSUFBSSxFQUFDTCxFQUFFLENBQUNNO0FBRkQsS0FGSDtBQU1SQyxJQUFBQSxXQUFXLEVBQUM7QUFDUkYsTUFBQUEsSUFBSSxFQUFDTCxFQUFFLENBQUNNLElBREE7QUFFUixpQkFB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QSxJQUFHZSxLQUFLLENBQUNsQyxNQUFOLENBQWFzQixJQUFiLElBQXFCLGFBQXhCLEVBQXNDO0FBQ3ZDUixNQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JVLFlBQWhCLENBQTZCLENBQTdCO0FBQ0EsV0FBS04sYUFBTDtBQUNILEtBSEksTUFJQSxJQUFHZSxLQUFLLENBQUNsQyxNQUFOLENBQWFzQixJQUFiLElBQXFCLGNBQXhCLEVBQXVDO0FBQ3hDUixNQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JVLFlBQWhCLENBQTZCLENBQTdCO0FBQ0EsV0FBS04sYUFBTDtBQUNIO0FBQ0osR0ExSUksQ0E0SUw7QUFDQTtBQUVBOztBQS9JSyxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgIFxyXG4gICAgICAgIF9idG5ZWE9wZW46e1xyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9idG5ZWENsb3NlOntcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBfYnRuWVlPcGVuOntcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBfYnRuWVlDbG9zZTp7XHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgYWRkQ2xpY2tFdmVudDpmdW5jdGlvbihub2RlLHRhcmdldCxjb21wb25lbnQsaGFuZGxlcil7XHJcbiAgICAgICAgY2MubG9nKGNvbXBvbmVudCArIFwiOlwiICsgaGFuZGxlcik7XHJcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLnRhcmdldCA9IHRhcmdldDtcclxuICAgICAgICBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gY29tcG9uZW50O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5oYW5kbGVyID0gaGFuZGxlcjtcclxuXHJcbiAgICAgICAgdmFyIGNsaWNrRXZlbnRzID0gbm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5jbGlja0V2ZW50cztcclxuICAgICAgICBjbGlja0V2ZW50cy5wdXNoKGV2ZW50SGFuZGxlcik7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBhZGRTbGlkZUV2ZW50OmZ1bmN0aW9uKG5vZGUsdGFyZ2V0LGNvbXBvbmVudCxoYW5kbGVyKXtcclxuICAgICAgICB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcclxuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBoYW5kbGVyO1xyXG5cclxuICAgICAgICB2YXIgc2xpZGVFdmVudHMgPSBub2RlLmdldENvbXBvbmVudChjYy5TbGlkZXIpLnNsaWRlRXZlbnRzO1xyXG4gICAgICAgIHNsaWRlRXZlbnRzLnB1c2goZXZlbnRIYW5kbGVyKTtcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHdpbmRvdy5BdWRpb01ncj09IG51bGwpe1xyXG4gICAgICAgICAgICBjYy5sb2coXCJ3aW5kb3cuQXVkaW9NZ3I9PSBudWxsXCIpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9ICAgICAgICAgICAgICAgXHJcbiAgXHJcbiAgICAgICAgdGhpcy5fYnRuWVhPcGVuID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueGlhb1wiKS5nZXRDaGlsZEJ5TmFtZShcImJ0bl95eF9vcGVuXCIpO1xyXG4gICAgICAgIHRoaXMuX2J0bllYQ2xvc2UgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW54aWFvXCIpLmdldENoaWxkQnlOYW1lKFwiYnRuX3l4X2Nsb3NlXCIpO1xyXG4gICAgICAgIHRoaXMuX2J0bllZT3BlbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnl1ZVwiKS5nZXRDaGlsZEJ5TmFtZShcImJ0bl95eV9vcGVuXCIpO1xyXG4gICAgICAgIHRoaXMuX2J0bllZQ2xvc2UgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW55dWVcIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXlfY2xvc2VcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fY2xvc2VcIikpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuX2V4aXRcIikpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5fYnRuWVhPcGVuKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuX2J0bllYQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5fYnRuWVlPcGVuKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuX2J0bllZQ2xvc2UpO1xyXG4gICAgICAgIFxyXG5cclxuICAgICAgICB2YXIgc2xpZGVyID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueGlhb1wiKS5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkU2xpZGVFdmVudChzbGlkZXIsdGhpcy5ub2RlLFwiU2V0dGluZ3NcIixcIm9uU2xpZGVkXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBzbGlkZXIgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW55dWVcIikuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9ncmVzc1wiKTtcclxuICAgICAgICB0aGlzLmFkZFNsaWRlRXZlbnQoc2xpZGVyLHRoaXMubm9kZSxcIlNldHRpbmdzXCIsXCJvblNsaWRlZFwiKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIG9uU2xpZGVkOmZ1bmN0aW9uKHNsaWRlcil7XHJcbiAgICAgICAgaWYoc2xpZGVyLm5vZGUucGFyZW50Lm5hbWUgPT0gXCJ5aW54aWFvXCIpe1xyXG4gICAgICAgICAgICB3aW5kb3cuQXVkaW9NZ3Iuc2V0U0ZYVm9sdW1lKHNsaWRlci5wcm9ncmVzcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2xpZGVyLm5vZGUucGFyZW50Lm5hbWUgPT0gXCJ5aW55dWVcIil7XHJcbiAgICAgICAgICAgIHdpbmRvdy5BdWRpb01nci5zZXRCR01Wb2x1bWUoc2xpZGVyLnByb2dyZXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBpbml0QnV0dG9uSGFuZGxlcjpmdW5jdGlvbihidG4pe1xyXG4gICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudChidG4sdGhpcy5ub2RlLFwiU2V0dGluZ3NcIixcIm9uQnRuQ2xpY2tlZFwiKTsgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICByZWZyZXNoVm9sdW1lOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fYnRuWVhDbG9zZS5hY3RpdmUgPSB3aW5kb3cuQXVkaW9NZ3Iuc2Z4Vm9sdW1lID4gMDtcclxuICAgICAgICB0aGlzLl9idG5ZWE9wZW4uYWN0aXZlID0gIXRoaXMuX2J0bllYQ2xvc2UuYWN0aXZlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB5eCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnhpYW9cIik7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gNDMwICogd2luZG93LkF1ZGlvTWdyLnNmeFZvbHVtZTtcclxuICAgICAgICB2YXIgcHJvZ3Jlc3MgPSB5eC5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpXHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q29tcG9uZW50KGNjLlNsaWRlcikucHJvZ3Jlc3MgPSB3aW5kb3cuQXVkaW9NZ3Iuc2Z4Vm9sdW1lO1xyXG4gICAgICAgIHByb2dyZXNzLmdldENoaWxkQnlOYW1lKFwicHJvZ3Jlc3NcIikud2lkdGggPSB3aWR0aDsgIFxyXG4gICAgICAgIC8veXguZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZSA9IHdpbmRvdy5BdWRpb01nci5iZ21Wb2x1bWUgPiAwO1xyXG4gICAgICAgIHRoaXMuX2J0bllZT3Blbi5hY3RpdmUgPSAhdGhpcy5fYnRuWVlDbG9zZS5hY3RpdmU7XHJcbiAgICAgICAgdmFyIHl5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueXVlXCIpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IDQzMCAqIHdpbmRvdy5BdWRpb01nci5iZ21Wb2x1bWU7XHJcbiAgICAgICAgdmFyIHByb2dyZXNzID0geXkuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9ncmVzc1wiKTtcclxuICAgICAgICBwcm9ncmVzcy5nZXRDb21wb25lbnQoY2MuU2xpZGVyKS5wcm9ncmVzcyA9d2luZG93LkF1ZGlvTWdyLmJnbVZvbHVtZTsgXHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9ncmVzc1wiKS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIC8veXkuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIG9uQnRuQ2xpY2tlZDpmdW5jdGlvbihldmVudCl7XHJcbiAgICAgICAgd2luZG93LkF1ZGlvTWdyLnBsYXlTRlgoXCJ1aV9jbGlja1wiKVxyXG4gICAgICAgIGNjLmxvZyhcIm9uQnRuQ2xpY2tlZFwiLGV2ZW50LnRhcmdldC5uYW1lKVxyXG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2Nsb3NlXCIpe1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2V4aXRcIil7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInd4X2FjY291bnRcIik7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInd4X3NpZ25cIik7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIlN0YXJ0U2NlbmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXhfb3BlblwiKXtcclxuICAgICAgICAgICAgd2luZG93LkF1ZGlvTWdyLnNldFNGWFZvbHVtZSgxLjApO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXhfY2xvc2VcIil7XHJcbiAgICAgICAgICAgIHdpbmRvdy5BdWRpb01nci5zZXRTRlhWb2x1bWUoMCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l5X29wZW5cIil7XHJcbiAgICAgICAgICAgIHdpbmRvdy5BdWRpb01nci5zZXRCR01Wb2x1bWUoMSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l5X2Nsb3NlXCIpe1xyXG4gICAgICAgICAgICB3aW5kb3cuQXVkaW9NZ3Iuc2V0QkdNVm9sdW1lKDApO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiJdfQ==